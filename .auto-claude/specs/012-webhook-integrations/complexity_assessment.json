{
  "complexity": "complex",
  "workflow_type": "feature",
  "confidence": 0.85,
  "reasoning": "Greenfield webhook system requiring new architectural patterns for event-driven delivery, database schema design, cross-cutting event hooks, retry mechanism, and security considerations for outbound HTTP calls. Estimated 10-15 files across backend and frontend with multiple integration points.",

  "analysis": {
    "scope": {
      "estimated_files": 12,
      "estimated_services": 2,
      "is_cross_cutting": true,
      "notes": "Backend: event emitters (5 event types), webhook service, database models, API endpoints, retry/queue logic. Frontend: webhook configuration UI, testing interface, logs viewer. Cross-cutting hooks needed in instance management, snapshot, failover, and cost monitoring systems."
    },
    "integrations": {
      "external_services": [],
      "new_dependencies": ["axios or node-fetch for HTTP", "potentially bull or bee-queue for retry logic"],
      "research_needed": true,
      "notes": "No external service integrations, but need to research webhook delivery patterns, retry strategies, security best practices for outbound HTTP, and potential queue systems for reliable delivery."
    },
    "infrastructure": {
      "docker_changes": false,
      "database_changes": true,
      "config_changes": true,
      "notes": "Requires new database tables: webhooks (id, user_id, event_type, url, secret, is_active), webhook_logs (id, webhook_id, event_type, payload, status, attempts, timestamps). May need background job infrastructure for retry logic. New env vars for webhook timeouts and retry configuration."
    },
    "knowledge": {
      "patterns_exist": false,
      "research_required": true,
      "unfamiliar_tech": ["webhook delivery patterns", "event-driven architecture", "retry mechanisms"],
      "notes": "This is a greenfield feature for the platform. Need to discover existing event emission patterns, background job systems, and queue mechanisms. Must design event hook architecture, retry logic, and security measures (webhook signature verification, URL validation)."
    },
    "risk": {
      "level": "high",
      "concerns": [
        "Webhook delivery failures could impact user experience if blocking",
        "Security: Malicious webhook URLs could be used for SSRF attacks",
        "Security: Webhook payloads could leak sensitive data",
        "Performance: Multiple webhooks firing simultaneously could overwhelm system",
        "Reliability: Retry logic must be robust without duplicating deliveries",
        "Data consistency: Webhook logs could grow unbounded without cleanup"
      ],
      "notes": "High risk due to security implications (outbound HTTP to user-controlled URLs), performance concerns (async delivery required), and reliability requirements (retry without duplication). Requires careful design of event hooks to avoid blocking main operations."
    }
  },

  "recommended_phases": [
    "discovery",
    "requirements",
    "research",
    "context",
    "spec_writing",
    "self_critique",
    "planning",
    "validation"
  ],

  "flags": {
    "needs_research": true,
    "needs_self_critique": true,
    "needs_infrastructure_setup": true
  },

  "validation_recommendations": {
    "risk_level": "high",
    "skip_validation": false,
    "minimal_mode": false,
    "test_types_required": ["unit", "integration", "e2e"],
    "security_scan_required": true,
    "staging_deployment_required": false,
    "reasoning": "Webhook system involves cross-cutting changes across multiple event sources, complex retry logic, and outbound HTTP calls to user-controlled URLs. Requires comprehensive testing for reliability (retry without duplication), integration tests for event-to-webhook pipeline, E2E tests for full flow, and security scanning for SSRF prevention and data leak detection. No staging deployment needed as this is application-level feature without infrastructure dependencies."
  },

  "created_at": "2025-01-01T00:00:00Z"
}
