{
  "complexity": "complex",
  "workflow_type": "feature",
  "confidence": 0.88,
  "reasoning": "GPU reservation system is a major feature requiring database schema changes, multiple service integrations (pricing, booking, capacity management), SLA enforcement logic, and credit management system. Cross-cutting concerns with high financial and operational risk.",

  "analysis": {
    "scope": {
      "estimated_files": 18,
      "estimated_services": 4,
      "is_cross_cutting": true,
      "notes": "Reservation system touches pricing, booking, capacity allocation, billing, and UI. Calendar interface, discount engine, credit rollover, and SLA enforcement each require multiple files."
    },
    "integrations": {
      "external_services": [],
      "new_dependencies": ["calendar-library", "scheduling-library"],
      "research_needed": true,
      "notes": "No external APIs but requires deep integration with existing pricing, booking, and capacity management systems. Need to understand current architecture patterns."
    },
    "infrastructure": {
      "docker_changes": false,
      "database_changes": true,
      "config_changes": true,
      "notes": "New database tables for reservations, credits, and rollover tracking. Configuration for discount rates, SLA parameters, and reservation policies."
    },
    "knowledge": {
      "patterns_exist": false,
      "research_required": true,
      "unfamiliar_tech": [],
      "notes": "Unknown if codebase has existing reservation or booking patterns. Must research pricing system integration points, capacity management architecture, and billing flows."
    },
    "risk": {
      "level": "high",
      "concerns": [
        "SLA guarantees require complex capacity planning and allocation",
        "Credit rollover has direct financial implications",
        "Discount calculations must integrate correctly with spot pricing",
        "Reservation enforcement could conflict with spot availability",
        "Premium feature requires proper authorization and access control",
        "Database schema design critical for reservation integrity"
      ],
      "notes": "High-risk feature with guaranteed availability SLA and financial components (discounts, credits). Incorrect implementation could result in overbooking or revenue loss."
    }
  },

  "recommended_phases": [
    "discovery",
    "requirements",
    "research",
    "context",
    "spec_writing",
    "self_critique",
    "planning",
    "validation"
  ],

  "flags": {
    "needs_research": true,
    "needs_self_critique": true,
    "needs_infrastructure_setup": true
  },

  "validation_recommendations": {
    "risk_level": "high",
    "skip_validation": false,
    "minimal_mode": false,
    "test_types_required": ["unit", "integration", "e2e"],
    "security_scan_required": true,
    "staging_deployment_required": true,
    "reasoning": "Reservation system with SLA guarantees and financial components (discounts, credit rollover) requires comprehensive testing. Security scan needed for premium feature access control and billing integration. Staging deployment required to verify database migrations and complex capacity allocation logic."
  },

  "created_at": "2025-12-31T00:00:00Z"
}
